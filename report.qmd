---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

**Research Project: International Crime** Research Question:

What kinds of crime have become more common in the past 15 years (2005-2020), both worldwide and regionally? Is the world becoming more or less violent? Do these rates correlate with regional and national GDPs?

**Insertion of Data:**

```{r}

library(tidyverse)
library(tidymodels)
gdp_un <- read.csv("data/GDP_GDPpC_UN_Altered.csv")
homicides_and_crime_un <- read.csv("data/Homicides_Other_Crimes_UN_Altered.csv")

```

**R-Squared of Data Set**

```{r}
gdp_un_2 <- gdp_un |>
  filter(str_detect(gdp_un$X, "Total")) |>
  mutate(Value = as.numeric(Value))

model2 <- linear_reg() |>
  set_engine("lm") |>
  fit(Value ~ Year, data = gdp_un_2)

glance(model2)$r.squared
```

**Africa Linear Regression Model:**

```{r}
homicides_and_crime_un |>
  filter(X == "Africa") |>
    mutate(Value = as.numeric(Value))
  
model_africa <- linear_reg() |>
  set_engine("lm") |>
  fit(Value ~ Year, data = homicides_and_crime_un)


```

**Has the world become more violent in the past 15 years (2005-2020), both worldwide and regionally, based on sex?**

1.  Worldwide violence, based on sex:

```{r}
#| label: worldwide-violence-sex

homicides_and_crime_un_sex <- homicides_and_crime_un_2 |>
  mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series != "Intentional homicide rates per 100,000")

homicides_and_crime_un_sex |>
  group_by(sex) |>
  ggplot(aes(x = Year, fill = sex)) +
  geom_bar(
    position = position_dodge2(preserve = "single")
  ) + 
  labs(
    x = "Year",
    y = "Percentage of Intentional Homicide Victims",
    title = "Intentional Homicide Victims by Sex",
    fill = "Sex"
  )

```

2.  Regional Violence, General:

```{r}
#| label: Africa

Africa_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Africa") 

Africa_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in Africa"
  )

```

```{r}
#| label: Northern-America

NAmerica_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Northern America") |>
  mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series != "Intentional homicide rates per 100,000")

NAmerica_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in N. America"
  )

```

```{r}
#| label: LA-And-Caribbean

LACarib_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Latin America & the Caribbean") |>
  mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series != "Intentional homicide rates per 100,000")

LACarib_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in Latin America and the Caribbean"
  )
```

```{r}
#| label: Asia

Asia_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Asia") |>
  mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series == "Intentional homicide rates per 100,000")

Asia_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in Asia"
  )
```

```{r}
#| label: Europe

Europe_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Europe") |>
  mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series == "Intentional homicide rates per 100,000")

Europe_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in Europe"
  )
```

```{r}
#| label: Oceania

Oceania_homicides_and_crime_un <- homicides_and_crime_un |>
  filter(X == "Oceania") |>
   mutate(
    sex = if_else(
      str_detect(Series, "Male"), "Male", "Female")
    ) |>
  filter(Series == "Intentional homicide rates per 100,000")

Oceania_homicides_and_crime_un |>
  ggplot(aes(x = Year, y = Value, group = 1)) +
  geom_line() +
  geom_point() + 
  labs(
    x = "Year",
    y = "% Homicide Victims Per 100k",
    title = "Intentional Homicide Victims in Oceania"
  )
```
